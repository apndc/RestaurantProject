<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1.0">
 <title>BookIt ‚Äî My Restaurants</title>
 <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<div id="deleteModal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
    background: rgba(0,0,0,0.5); justify-content:center; align-items:center;">
    <div style="background:#fff; padding:20px; border-radius:10px; max-width:400px; text-align:center;">
        <h3 style="color:red;">Confirm Deletion</h3>
        <p>Are you sure you want to delete your account? This action cannot be undone.</p>
        
        <form method="POST" action="{{ url_for('delete') }}">
            <button type="submit" style="background:red; color:white; padding:8px 12px; border:none; border-radius:5px; margin-right:10px;">Yes, Delete</button>
            <button type="button" id="cancelDelete" style="padding:8px 12px; border:none; border-radius:5px;">Cancel</button>
        </form>
    </div>
</div>

<body>
    <header>
        <nav style="display:flex; justify-content:space-between; align-items:center; padding:10px 20px; background:#f8f8f8; border-bottom:1px solid #ddd; width:100%;">
            <!-- Logo -->
            <a href="{{ url_for('dashboard') if session.get('user_id') else url_for('home') }}" class="logo">üçΩÔ∏è BookIt</a>
        
            <!-- User Menu container aligned to top-right -->
            <div style="margin-left:auto; position:relative;">
                <button id="userMenuBtn" style="background:none; border:none; cursor:pointer; color: var(--brown); font-weight:bold;">
                    {{ user_name or 'My Profile' }} ‚ñº
                </button>
        
                <!-- Dropdown Menu -->
                <div id="userDropdown" style="display:none; position:absolute; right:0; top:100%; background:#fff; border:1px solid #ddd; border-radius:5px; box-shadow:0 2px 5px rgba(0,0,0,0.2); min-width:150px; z-index:100;">
                    <a href="{{ url_for('edit_account') }}" style="display:block; padding:10px; text-decoration:none; color:#333;">Edit Account</a>
                    <button id="deleteBtnNav" style="display:block; width:100%; padding:10px; border:none; background:none; text-align:left; color:red; cursor:pointer;">Delete Account</button>
                    <a href="{{ url_for('logout') }}" style="display:block; padding:10px; text-decoration:none; color:#333;">Log Out</a>
                </div>
            </div>
        </nav>        
    </header>

    <main class="owner_landing">
        <section class="restaurants" style = "grid-column: 1/-1;">
            <h3> My Restaurants</h3>
            {% if restaurants %}
                <div class="res_list">
                    {% for r in restaurants %}
                    <article class="res_item">
                        <div>
                            <div class="res_destination"> {{r.Name}} </div>

                            {% if r.location %}
                            <div class="res_size">
                                {{r.location.StreetName}},
                                {{r.location.City}},
                                {{r.location.State}},
                                {{r.location.ZipCode}}


                            </div>
                            {% endif %}

                            {% if r.Cuisine %}

                            <div class="res_size">
                                Cuisine: {{ r.Cuisine }}
                            </div>
                            {% endif %}
                        </div>
                        <div style="display: flex; gap:0.5rem; align-items: center;">
                            <a href="{{url_for('restaurant', name=r.Name)}}" class="welcome_page button" style="padding:0.4rem 0.8rem;">
                                View Page
                            </a>
                            
                        </div>
                    </article>
                    {% endfor %}
                </div>
                {% else %}
                <p>You don't have any restaurants yet? Let's Change that!</p>
                {% endif %}

                
        </section> 
    </main>

    <script>
        const userMenuBtn = document.getElementById('userMenuBtn');
        const userDropdown = document.getElementById('userDropdown');
        
        userMenuBtn.addEventListener('click', () => {
            userDropdown.style.display = (userDropdown.style.display === 'block') ? 'none' : 'block';
        });
        
        // Close dropdown if clicked outside
        document.addEventListener('click', (e) => {
            if (!userMenuBtn.contains(e.target) && !userDropdown.contains(e.target)) {
                userDropdown.style.display = 'none';
            }
        });
        
        // Delete Account Modal
        const deleteBtnNav = document.getElementById('deleteBtnNav');
        const deleteModal = document.getElementById('deleteModal');
        const cancelDelete = document.getElementById('cancelDelete');
        
        deleteBtnNav.addEventListener('click', () => {
            deleteModal.style.display = 'flex';
        });
        
        cancelDelete.addEventListener('click', () => {
            deleteModal.style.display = 'none';
        });
    </script>
        
</body>
</html>