<!doctype html>
<html>
  <head>
    <title>{% block title %}BookIt{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
  </head>
  
  <body>
    <header style="display:flex; justify-content:space-between; align-items:center; padding:1rem 2rem; background:var(--tan); border-bottom:2px solid #bba36b;">
      <!-- Logo -->
      <a href="{{ url_for('home') }}" class="logo">üçΩÔ∏è BookIt</a>

      <!-- User Menu -->
      <div style="position:relative;">
        <button id="userMenuBtn" style="background:none; border:none; cursor:pointer; color:var(--brown); font-weight:bold;">
          {{ g.current_user.FirstName or 'My Profile' }} ‚ñº
        </button>

        <!-- Dropdown Menu -->
        <div id="userDropdown" style="display:none; position:absolute; right:0; top:100%; background:#fff; border:1px solid #ddd; border-radius:5px; box-shadow:0 2px 5px rgba(0,0,0,0.2); min-width:150px; z-index:100;">
          <a href="{{ url_for('edit_account') }}" style="display:block; padding:10px; text-decoration:none; color:#333;">Edit Account</a>
          <button id="deleteBtnNav" style="display:block; width:100%; padding:10px; border:none; background:none; text-align:left; color:red; cursor:pointer;">Delete Account</button>
          <a href="{{ url_for('logout') }}" style="display:block; padding:10px; text-decoration:none; color:#333;">Log Out</a>
        </div>
      </div>
    </header>

    <div id="deleteModal" style="display:none; position:fixed; inset:0; background: rgba(0,0,0,0.5); justify-content:center; align-items:center;">
      <div style="background:#fff; padding:20px; border-radius:10px; max-width:400px; text-align:center;">
        <h3 style="color:red;">Confirm Deletion</h3>
        <p>Are you sure you want to delete your account? This action cannot be undone.</p>
        
        <form method="POST" action="{{ url_for('delete') }}">
          <button type="submit" style="background:red; color:white; padding:8px 12px; border:none; border-radius:5px; margin-right:10px;">Yes, Delete</button>
          <button type="button" id="cancelDelete" style="padding:8px 12px; border:none; border-radius:5px;">Cancel</button>
        </form>
      </div>
    </div>
    <main>
        {% block content %}{% endblock %}
    </main>
  </body>

  <script>
    const userMenuBtn = document.getElementById('userMenuBtn');
    const userDropdown = document.getElementById('userDropdown');

    userMenuBtn.addEventListener('click', () => {
      userDropdown.style.display = (userDropdown.style.display === 'block') ? 'none' : 'block';
    });

    // Close dropdown if clicked outside
    document.addEventListener('click', (e) => {
      if (!userMenuBtn.contains(e.target) && !userDropdown.contains(e.target)) {
        userDropdown.style.display = 'none';
      }
    });

    // Delete Account Modal
    const deleteBtnNav = document.getElementById('deleteBtnNav');
    const deleteModal = document.getElementById('deleteModal');
    const cancelDelete = document.getElementById('cancelDelete');

    deleteBtnNav.addEventListener('click', () => {
      deleteModal.style.display = 'flex';
    });

    cancelDelete.addEventListener('click', () => {
      deleteModal.style.display = 'none';
    });
  </script>

</html>
